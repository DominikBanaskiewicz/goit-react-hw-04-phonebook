refactor poprzeniej wersji na hooki
